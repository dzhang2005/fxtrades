<!DOCTYPE html>
<html lang="en">
<head>
<title>Prototype Page</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<script type="text/javascript" src="angular.js"></script>
<script type="text/javascript" src=angular-animate.js></script>
<link rel="stylesheet" href="css/bootstrap.css">
<link rel="stylesheet" href="css/UCMS-Custom.css" />
<script src="jquery-2.2.3.js"></script>
<script type="text/javascript" src="jquery.blockUI.js"></script>
<script src="bootstrap.js"></script>
<script src="ui-bootstrap-tpls-1.3.2.js"></script>
<script src="mask.js"></script>
<script src="modernizr.js"></script>

<link rel="stylesheet" href="css/second.css">
</head>
<body class="container" ng-app="myApp">
	<div class="page-header">
		<p><h2>Trade Signal</h2></p>
	</div>
	<div class="table-responsive" ng-controller="myCtrl">
	<table
		class="table table-condensed table-bordered table-striped table-hover">
		<tr ng-repeat-start="signal in signalList">
			<td>Last Refresh</td>
			<td>Side</td>
			<td>Symbol</td>
			<td>Entry Price</td>
			<td>Create Date</td>
			<td>Last Price</td>
			<td>Profit</td>
            <td>Nick Name</td>
		</tr>
		<tr>
			<td>{{signalRetrieveTime | date: 'MM/dd/yyyy hh:mma'}}
			<td>{{signal.side}}</td>
			<td>{{signal.symbol}}</td>
			<td>{{signal.entryPrice}}</td>
			<td>{{'2016-05-01T23:20:51' | date : 'MM/dd/yyyy hh:mma' }}</td>
			<td>{{signal.lastPrice}}</td>
			<td>{{signal.profit}}</td>
            <td>{{signal.userNickName}}</td>
		</tr>
		
		<tr ng-repeat-end>
		<td colspan="8"><img alt="Trend image" ng-src="{{signal.chart}}" width="100%"></td>
		</tr>
	</table>
	</div>


<script>
	angular.module('myApp', []).config(function($httpProvider){
	    delete $httpProvider.defaults.headers.common['X-Requested-With'];
	}).factory('myService', function($http) {
		return {
			latestRetrieveTime: new Date();
			latestRetrieveList : function() {
		 		$http.get("http://localhost:8089/json?operation=getfxtrades"
 	            ).then(function(response) {
					return response.data.content;
				}, function(reason) {
					console.log(reason);
					return null;
				}, function(value) {
					console.log(value);
					return null;
				} 
				return null;
			};
		}}).controller('myCtrl', function($scope, $http, $interval) {
			$scope.signalRetrieveTime = myService.latestRetrieveTime;
			$scope.signalList = myService.latestRetrieveList;
			$interval(function() {
				if (myService.latestRetrieveList) {
					$scope.signalRetrieveTime = myService.latestRetrieveTime;
					$scope.signalList = myService.latestRetrieveList;
				}
			}, 60000);
		});
</script>
</body>
</html>
